<!DOCTYPE html>
<html lang="en">




<!--||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
	||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
	||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
	||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
 
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
(((((//*,,,,,,,,,,,,,................/((///**,,......    .*,...................,,,,,**///*,
////////**,,,,....,,,,...         .(((((/**,,,..           ,(,        ...........,,,,*////.
*//////******,,,..........       &(#%%%(/**,,....            %%.       ..........,,,*/(/*/,
***************,,,...........   @%%&&&%#/*,,.....             ((.    ..............,,/((**,
*****************,,,.......... *@&&&&%%#/*,,.......           .*,...........,,,,..,,*/((/**
,,***,,,,,,********,,,... .....@&&%%%##/*,,........            ,*..........,,,,,,,,*/(/(/**
,,,,,,,,,,,,*,*******,,........@&%%%#((//,,,..,.,**(((/*,,.    ,**.............,,*,,,*/((//
,,,,,,,,,,,,,,,,,,,,,,,,,......#@%&@@@@@@@%&%*///(%/%@@#* .    ,(*.............,,,,,,*/(#%(
.,,,,,,,,,,,,,,,,,,,,,,,,,,....#@@@@@@@@@@@@@@&%.,(@@@@@, ,    .(,            ..,,,,,*//((/
...,,,,,,,,,,,,,,,,,,,,,,,,,,.,@@@@@@@@@@@@@,//,..#@@@@@(.      *.            .......,,,***
.......,,,,,,,,,,,,,,,,,,,,,,,/@@@@@@@@@@@@#/(.   .,(@%/,.      *.,(                .,,,,,*
.............,,,,,..,,,.....,,@&@@@@@@@@@@@#@/.    ...,*,,.     ,, #.               .,,.,,*
  ............................%@%@@@@@@@@@@@@(.      .,,,.. .   ** ,              .....,,**
.     .........................@/%@@@@@@@@@@%*,.    ...         ,.          ..........,,*/*
 .          ...................*/(&@(/#@%@@@*. (/  ..            ................,,,,,***
                             ...(*#&%#(/%&@@@@.,                . ...................,,,***
.                          )   ../((&&%&&&@(.#.               .....              .....,,,
                           (     ,#(@@@&@&@##,.*.                                  . .....,
                           x_____..,  ../@@@@@&/,..   .               ....  ..........,,,,*
             .                     %#@&&@@@%(**,                    .................,,,,,*
                                   ,&@@@&%%#/**,.                   .........,,,,,,,,,,,,,*
                                    %%@@@%(//*,.             @&&* .,,,,,,,,,,,,,,,,,*****//
                                    .%&@@@(*,.            .@@@%*,. .,,,,,,,,,,,,(&@@@@@@@
                                  ,@@@@@@@@&(/,,.           (@@@@@#*.,,  ,,,..,,*@@@@@@@@@@
                                /@@@@@@@@@@@%#(//*,.  ....*@@@@@@@@#(@@&%&.....,/@@#&@@@@@@
                               &@@@@@@@@@@@@@%*,....,,*/&@@@@@@@@@@&&(@##(#  .,(@@@&%(@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

Thanks to fellow Kentuckian, Hunter S. Thompson, for the inspiration: 
"It is not necessary to accept the choices handed down to you by life as you know it."
 
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

 
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
||||||||||||THANKSFORTHESUPPPORTNANCY<3|||||||||||||||||||||||||||||||||||||||||||||||||||
|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| -->
        <meta charset="utf-8">
  
<!-- <script type="text/javascript"> if(typeof navigator.vendor!='undefined' && navigator.vendor.toLowerCase().indexOf('apple')!=-1){
		document.location = "/stories/viewfinderradness/";
}

</script>
-->
 

<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
<!-- 
  <meta name="viewport" content="width=device-width, user-scalable=no">
 -->
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />






<meta property="og:title" content="">
<meta property="og:site_name" content="">
<meta property="og:url" content="https://cultureondemand.com/stories/phenomenalradness/si/">
<meta property="og:description" content=".">
<meta property="fb:app_id" content="1356557814369632">
<meta property="og:type" content="website">



<meta name="twitter:card" content="" />
<meta name="twitter:site" content="@" />
<meta name="twitter:creator" content="@" />
 <meta property="og:image" content="http://cultureondemand.com/stories/phenomenalradness/si/greatbasin.jpg" />





<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicon-194x194.png" sizes="194x194">
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">
<meta name="theme-color" content="#f000f0">


<title></title>
 
<meta name="Description" content=".">



<script src = "/js/three.min.js" ></script>
  <!--    <script src="/js/device.js"></script> -->
    <script src = "/js/Detector.js"></script>
    <script src = "/js/Tween.js"></script>

  		    <script src="/js/jquery-2.0.0.min.js"></script>
 		    
 		      	<link rel="stylesheet" href="/stories/loader.css">

 
 
 
 	<script src="/js/THREE.ConstantSpline.js"></script>
<script src="/js/Maf.js"></script>



 <!--  out 6/8/18
 <script src="THREE.MeshLine.js"></script>

 -->

		<script src="/js/ImprovedNoise.js"></script>
<script src="/js/CurveExtras.js"></script>
  <script src = "/js/vr/VREffect.js"></script>
  <script src = "/js/vr/VRControls.js"></script>
<script src="/js/vr/webvr-polyfill.js"></script>
<script src="/js/vr/webvr-manager.js"></script>
 
 
<script src = "/js/controls/OrbitControls.js"></script>
<!--     <script src = "/js/controls/TrackballControls.js"></script>
 
		<script src = "require.min.js"></script>
	 -->


    <script src="/stories/trackingjsofy/TRACKING/build/tracking.js"></script>


  



  
<script type="application/x-glsl" id="sky-vertex">  
varying vec2 vUV;

void main() {  
  vUV = uv;
  vec4 pos = vec4(position, 1.0);
  gl_Position = projectionMatrix * modelViewMatrix * pos;
}
</script>

<script type="application/x-glsl" id="sky-fragment">  
uniform sampler2D texture;  
varying vec2 vUV;

void main() {  
  vec4 sample = texture2D(texture, vUV);
  gl_FragColor = vec4(sample.xyz, sample.w);
}
</script>  
<!-- /skybox shaders -->

 <!-- ############################### HTML5 AUDIO PRE HOWLER

<audio autoplay loop id="myAudio">
<source src="sounds/lifestylesoftherich.mp3" type="audio/mp3"></audio>

<source src="sounds/lifestylesoftherich.ogg" type="audio/ogg"></audio>
  <button onclick="document.getElementById('myAudio').play()">START SOUND</button>
</audio>
######################################## -->





 
<style>
body {
    background: #fafafa;
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    color: #333;
    overflow: hidden;
    margin: 0;
/*    	cursor: none; */

}

 
.container { display:none; }


a {
color:#0fff0 !important;
}

.info{ font-family: sans-serif; position: absolute; color: #fff; background: rgba( 0, 0, 0, .8 );	bottom: 20px;
	right: 20px;
	padding: 5px;
	text-align: right;
 }
.info a{color: inherit;  }

 
 

#info a:hover, #blog a:hover {
	text-decoration: underline;color: inherit; 
}

#info div {
	padding: 0 5px;font-family: sans-serif; position: absolute; color: #fff; background: rgba( 0, 0, 0, .8 );	bottom: 20px;
	right: 20px;
	padding: 5px;
	text-align: right;
}

#info div img {
	position: relative;
	top: 9px;
	border-radius: 3px;
}

#info #artist {
	margin-right: 5px;
	font-family:'Trocchi', sans-serif;
}

#info #artist .name {
	font-size: 0.8em;
}

#info #artist .song {

}

 
#play {
	position: fixed;
	top: 0;
	left: 0;
	background-color: rgba(0, 0, 0, 0.6);
	display: none;
}

#play_link {
	position: fixed;
	top: 0;
	left: 0;
	height: 252px;
	width: 129px;
	background: url('/stories/images/play.png') left center no-repeat transparent;
	cursor: pointer;
}


#playplay {
	position: fixed;
	background-color: rgba(0, 0, 0, 0.8);
	top: 0;
	left: 0;
	height: 100%;
	width: 100%;
	cursor: pointer;
}


.playplay-button {
	position: fixed;
	background-color: rgba(0, 0, 0, 0.3);
		 background: url('/stories/images/play.png') center no-repeat transparent;
top: 0;
	left: 0;
	height: 252px;
	width: 129px;
 	cursor: pointer;
}

#blog {
	position: absolute;
	bottom: 20px;
	left: 20px;
	padding: 5px;
}

#intro {
   font-family: 'Trocchi', serif;
  position:absolute;
  display:block;
  width:36%;
 }

#intro>p:first-child:first-letter {
color:#f000f0;
display:inline;
float:left;
font-size:5.3em;
font-family:'Vast Shadow', sans-serif;
line-height:0.7em;
margin:0.03em 0.04em 0 0;
text-transform:uppercase;
}

 
  
#introB {
   font-family: 'Trocchi', serif;
  position:absolute;
  display:block;
 }

#introB>p:first-child:first-letter {
color:#f000f0;
display:inline;
float:left;
font-size:5.2em;
font-family:'Vast Shadow', sans-serif;
line-height:0.8em;
margin:0.03em 0.04em 0 0;
text-transform:uppercase;
}

 
  
	
		    #container { z-index:0; }
	    #vidCanvas { display: none; z-index:0; }
    #lineCanvas { position: absolute; top: 5em; left: 1em; color: white; z-index:9999; }

	    #inputCanvas { display: none; z-index:0; }
    #inputVideo { position: absolute; right: 0; bottom: 0; z-index:0; -webkit-transform: scaleX(-1);}
    #overlay { position: absolute; right: 0; bottom: 0; z-index:0; -webkit-transform: scaleX(-1);}
    #selector { position: absolute; top: 5em; left: 1em; color: white; z-index:9999; }
    #forkme { z-index:99; }
    #soundcloud-url { width: 250px; }
  
	#containerb { 
	display:block;
 	height: 100%;
	width: 100%;
}


	
	</style>
	  <link href='https://fonts.googleapis.com/css?family=Trocchi|Vast+Shadow' rel='stylesheet' type='text/css'> 

	
         <script src="/phenomenal/storytelling/3JS/tests/js/dat.gui.min.js"></script>

 
	 <script type="text/javascript">
<!--
    function toggle_visibility(id) {
       var e = document.getElementById(id);
       if(e.style.display == 'block')
          e.style.display = 'none';
       else
          e.style.display = 'block';
    }
//-->
</script>

 

         <script>

/**
 *
 * WebCam Mesh by Felix Turner
 * @felixturner / www.airtight.cc
 * (c) Airtight Interactive Inc. 2012
 *
 * Connects HTML5 WebCam input to a WebGL 3D Mesh. It creates a 3D depth map by mapping pixel brightness to Z-depth.
 * Perlin noise is used for the ripple effect and CSS3 filters are used for color effects.
 * Use mouse move to tilt and scroll wheel to zoom. Requires Chrome or Opera.
 *
 */
 
 


var torii = [];

var torigeometry;



var container, mesh;

var bkgScene, clock, pCount = 0, particleSystem = null;
var renderhooks = [];


var fov = 66;


var canvasWidth = 256 / 2;
var canvasHeight = 128 / 2;
var vidWidth = 256;
var vidHeight = 128;
var width = 256;
var height = 128;
var tiltSpeed = 0.1;
var tiltAmount = 0.5;

var perlin = new ImprovedNoise();
var camera, scene, renderer;
var mouseX = 0;
var mouseY = 0;
var windowHalfX, windowHalfY;
var video, videoTexture, videoV, videoTextureV;
var world3D;
var geometry, Ground;
var vidCanvas, lineCanvas, linectxx;
 var pixels;
var noisePosn = 0;
var wireMaterial;
var vidwireMaterial,vidvidwireMaterial, wireMaterialal, materiala;
var meshMaterial, vidmeshMaterial, vidmirror, vidvidmirror,gridcolor;
var material, uniforms = [], skyBoxgeom;
 var params,fog;
var title, info, prompt;

var owl, bunny, wolfGeometry;
var cube_materialB, cube_materialBB;
var materiala, materialag, immaterialagg, immaterialaggg, immaterialag;
 
 
 
var frontcolor;
//////
///////
//////


var source, sourceJs;

var audioCtx,analyser,bufferLength,dataArray;
/////
////
///////




  var light, ambientLight, pointLight, hallo, moon, galaxy, oldWall;

     var t           = 0;
     var diameter    = 1200;
     var dist_x      = 0;
     var step        = 0;



			// 3d model setup
			
			
			var camera, cubeCamera, scene, renderer,skyMaterial,skyBox;
			var cube, sphere,  sphereQ, torus;
 			var textureYO, meshYOYO, materialXOXO;

			var mesh;
			var material_sphere1, material_sphere2;


 
 

var materialx, particulas, objeto;
var  frequencyData;
 var positions, sprite, text;
var ctx,ctxx;
	 var cubeContainer, cubes = [];
var cubegeo, geometrygeo, materialgeo;
	 var cubeContainergeo, cubesgeo = [];
var cubegeogeo, geometrygeogeo, materialgeogeo;


 var lengthX;
            var lengthY;


 	 var sphereo = [];


var meshwzw;
var meshw;
var meshww;
var meshwww;
var oceanframe, mirror, vidmirror, vidvidmirror, vidvidmirrormirror, wiremirror,ocean;
var vidmirrorg, vidmirror;
var mCubeCamera, mmCubeCamera;
var listener, listenerer;
var offset, cubew;

var handler, handlerer, handlerr;



			var stats;
 			var plane;
			
			


////////// 
///////
///////// 


var meshwzwa;
var meshw;
var meshww;
var meshwww;
var meshwa;
var meshwwwai;

var Ameshwa;
var Cmeshwa;




var meshwwa;
var meshwwwa;
var meshwwwa = [];
var meshwwwe;
var objobjobjobj;
var objobjobjobjs;

var meshwwweo = [];

var kkkks;

var izi=0;

var dogMaterial, owlMaterial, bunnyMaterial, skullMaterial;

var oceanframe, mirror, vidmirror, vidvidmirror, vidvidmirrormirror,vidvidwiremirror, wiremirror,ocean;

var mCubeCamera, mmCubeCamera;
var listener, listenerer;
var offset, cubew;

var handler, handlerer, handlerr;



  			var plane;
			
			
		 var iii = 0;

		
 		
			
 
 
	//init HTML elements


 


var aSkyDome;

var sgeometry, spline, box, counter = 0;

var positions, buffer_geometry;


 var positions, sprite, text;
var ctx;
	 var cubeContainer, cubes = [];
var cubegeo, geometrygeo, materialgeo;
	 var cubeContainergeo, cubesgeo = [], cubeContainergeoZZZ, cubesgeoZZZ = [];
var cubegeogeo, geometrygeogeo, materialgeogeo;



 var     // holds the context
    frequencyData, // the data Array -> Uint8Array[1024]
    bufferLength,  // 1024
    processor,
    recorder;        // the audio source
	

 var oldx;
var oldy;
var oldz;

 

////////
/////
//////
////////////


 	
	var noiseTexture, noiseTexture, verticalMirror, verticalMirrorMesh;
 
   
 

///////
/////
/////
////////
 
			var SCREEN_WIDTH = window.innerWidth;
			var SCREEN_HEIGHT = window.innerHeight;
			var FLOOR = -250;



//////////
////////
//////////////////

 
			
			///////
			//////
			/////////////////
			/////////////
			/////////
			////////////////////

 
 
 
//////////////////////////////////////////
//////////////////////////////////////////
//////////////////////////////////////////
    //   Setup three.js
//////////////////////////////////////////
var main_color = 0x000000;
var canvas_height = window.innerHeight;
var canvas_width = window.innerWidth;



 

//////////////
// SCENE
//////////////
var width = window.innerWidth;
var height = window.innerHeight;
var clock = new THREE.Clock();
var scene = new THREE.Scene();
 
var raycaster = new THREE.Raycaster();
var mouse = new THREE.Vector2();

var offset = new THREE.Vector3();

var vector = new THREE.Vector3();

 	var vectorvector = new THREE.Vector3();

	//////////////
 ////////////////////
////////////////////	
	
	
	var tangent = new THREE.Vector3();
var axis = new THREE.Vector3();
var up = new THREE.Vector3(0, 1, 0);

var splineCamera, cameraHelper, cameraEye;

		var text, plane;


	
	
 var mirror, ocean;


var scaler;
var scalerB;
var scalerZ;



	var zoom = 1;
	var mOpac = 1;
	var wfOpac = .1;
	var contrast = 1.2;
	var saturation = 1.2;
	var invertZ = false;
	var zDepth = 124;
 

	var noiseStrength = 20;
	var noiseScale = .013;
	var noiseSpeed = 0.03;



 
 
 
	//add mirror plane
//// var planea = new THREE.PlaneGeometry(1500, 1000, canvasWidth, canvasHeight);
//// planea.dynamic = true;


 
 
 //
  
var prad = new THREE.TextureLoader().load('greatbasin.jpg');
var pradmat = new THREE.MeshBasicMaterial( { map: prad} );

prad.anisotropy = 0;
prad.magFilter = THREE.NearestFilter;
prad.minFilter = THREE.NearestFilter;


var pradgeo = new THREE.PlaneGeometry(400, 200, canvasWidth, canvasHeight);



 



//// var waterNormals = new THREE.TextureLoader().load('/stories/ocean/assets/img/waternormals.jpg');
 		var waterNormals = new THREE.TextureLoader().load('/stories/wildbeast/images/sand.png');
		waterNormals.wrapS = waterNormals.wrapT = THREE.RepeatWrapping; 




 
 
var material = new THREE.MeshBasicMaterial( { color: 0x9d4e56, wireframe: true, side: THREE.DoubleSide  } );
var materialll = new THREE.MeshBasicMaterial( { color: 0x46211c, wireframe: true } );
var materialy = new THREE.MeshBasicMaterial( { color: 0x4f1c17, wireframe:false, side: THREE.DoubleSide } );

		
  
////////


 // Theo Armour ~ 2014-03-06 ~ MIT License

	var uf = uf || {};
    var map, tex, spr, geom;
    var newVal = 1;

var particle;

 var box;

var sprite1, mesh1;
var canvas1, context1, texture1;

var contextcontext;

 var materialx, particulas, objeto;



var lastRender = 0;

		 
clock.start();


var video_frame;
var canvas;
var imcanvas;
var start_tracking, stop_tracking;


	       var loader = new THREE.JSONLoader();


///////////////////////////////////// 

  
 var photoloader = new THREE.TextureLoader();
 

    var xmin;
var xmax;

var sphereGeometry;
var containerb;


var line;
var MAX_POINTS = 100;
var drawCount;




// geometry
	var llgeometry,llpositions,llmaterial,llline;

 ///
//////
///


 
var lines = [];
var resolution = new THREE.Vector2( window.innerWidth, window.innerHeight );
var strokeTexture;



var TAU = 2 * Math.PI;
var hexagonGeometry = new THREE.Geometry();
for( var j = 0; j < TAU - .1; j += TAU / 100 ) {
	var v = new THREE.Vector3();
	v.set( Math.cos( j ), Math.sin( j ), 0 );
	hexagonGeometry.vertices.push( v );
}
hexagonGeometry.vertices.push( hexagonGeometry.vertices[ 0 ].clone() );
 
  
  

var lmholder;

</script>
  

</head>
<body>


<!-- <div class="info"></div> -->



    
 			<div id="loader-wrapper">
 <div id="loader"><div id="werdz" style="font-family:Vast Shadow, sans-serif; width:100%; display:block;top:54%;color:#fff;z-index:11111;position:absolute;line-height:normal; "><img src="/stories/campfire.png" border="0"></div></div>

 <div class="loader-section section-left"></div>
 <div class="loader-section section-right"></div>

		</div>
		
		
	            <!--     <button id="start" class="btn btn-primary">Resume Tracking</button>
                <button id="stop" class="btn btn-primary">Pause Tracking</button>
	
				-->
         

 <div id="info" style="display: inline !important; "><span id="loading_dots" style="display: none !important; "></span></div>


      

<div id="background" style="margin:0; padding:0;float:left; z-index:33; display:none; position:fixed; left:0px; top:0px;width:100%;height:100%; background-color: rgba(0, 0, 0, 0.8); " onclick="toggle_visibility('background');toggle_visibility('intro');toggle_visibility('infoB');toggle_visibility('goes');toggle_visibility('cursorhelp');toggle_visibility('infoD');toggle_visibility('infoC'); "> 
</div>
 


   <div id="cursorhelp" style="display:none;position:absolute;left:42%;bottom:25%;opacity:1;z-index:99999;"  onclick="toggle_visibility('cursorhelp');"><a href="#"><img src="/stories/images/cursoradvice.gif" border="0"></a></div>



<div id="logo" style="margin:0; padding:0;float:right; z-index:993331; display:block; position:absolute; right:12px; top:6px; ">
</div>

  


<div id="foo" style="margin:0; padding:1em;float:left; z-index:333333; display:block; position:absolute; right:0px; top:0px;display:none;width:308px; background-color: rgba(0, 0, 0, 0.7); "> 
<div style="display:block;width:100%;">
<br /><br />
 </div>
 
 
 <!--
<div style="display:block;width:100%;padding-bottom:18px; ">


<a href="#" onclick="toggle_visibility('foo');toggle_visibility('faq');toggle_show('tracker_map');toggle_show('tracker_marker');"><img src="/stories/images/faqh.png" border="0" width="100%" alt="A little help with this thing"></a>      
</div>
-->

  
   
  
 
  <div style="display:block;width:100%;padding-bottom:18px; ">


 </div>
  <div>
   

   
     
<!--     OUT - Count : <span id="outCount"></span>
    <select name="outputPort" id="outputPort" size="1" onchange="MIDI.changeOutput()" >
      <option value="off">OFF</option>
    </select>
 -->
  
  
  
  



   </div>


   
 </div>
 
 
   <div id="infoB" style="color:#fff; padding-left:3em;padding-top:1em;padding-bottom:1em;padding-right:1em;float:left; z-index:333333; display:block; position:absolute; left:0px; top:1em; background-color: rgba(0, 0, 0, 0.7);overflow:hidden; 
  font-size:1.8em;
font-family:'Vast Shadow', sans-serif;
line-height:1em;
text-transform:uppercase; "></div>

 
  <div id="intro" style="margin:0;float:left; z-index:3331; display:block; position:absolute;left:3em; top:7em; color:#ffffff; font-size:1.1em; line-height:1.4em; overflow:scroll; ">        
  
  
  <!-- 
  
  <p>An art robot that turns real life into a psychedelic 3D storyworld animated by all the sound and motion in its environment. Built to power large-scale interactive projection mapping installations and environments. Accesses your mic and cam. You can also talk to me using real, real basic and random words and phrases. Motion Reactive / Sound Reactive / Speech Recognition / WebVR enabled. <strong>Created by Eric Cade Schoenborn, 2016</strong>


<p>An art robot that turns real life into a psychedelic 3D storyworld animated by all the sound and motion in its environment. Motion Reactive / Sound Reactive / Speech Recognition / WebVR enabled. <strong>Created by Eric Cade Schoenborn, 2016</strong>
-->

  
 </div>


 <div style="color:#fff; margin:0; padding:1em;float:left; z-index:333333; display:none; position:absolute; left:0px; bottom:1em; background-color: #f000f0; font-size:1em; font-family: 'Trocchi', serif; " id="infoC">Talk to me in caveman, robot speak. I speak some random words and phrases.
 
 
 </div>


 <div style="color:#fff; margin:0; padding:1em;float:left; z-index:333333; display:none; position:absolute; left:0px; bottom:5em; background-color: #f000f0; font-size:1em; font-family: 'Trocchi', serif; " id="infoD">Requires a  <a href="http://caniuse.com/#search=getusermedia" target="_blank">a browser</a> that allows access to your microphone and camera.
 
 
 </div>
 
<!-- ############ Renderer ####### -->
<div id="containerb"></div>    
<!-- ############################## -->  

    <div class="container">
             <!--   -->  <video playsinline autoplay loop id="myVideo" width="512" height="256"></video> 
                 <video playsinline autoplay loop id="myVideoV" width="512" height="256"></video>
                 <canvas id="canvas" width="512" height="256"></canvas>
      </div>
 
        
 	<!--  	<video id="video" autoplay loop style="display:none"></video> -->
 



 
  <div id="play" style="width: 100%; height: 100%; display:none; "><div id="play_link"></div></div>
 
     
    <!--note: the audio element don't have a source attribute because we input live
    
  <audio id="player" preload="auto" style="display:none"></audio>

-->
 

   <!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/annyang/1.4.0/annyang.min.js">   </script>
-->
   <script>
/* */

video_frame = document.getElementById("myVideo");
canvas = document.getElementById("canvas");
canvas.style.display = 'none';

imcanvas = canvas.getContext("2d");

/* took out 6/8/18
*/


/* this was already taken out
start_tracking = document.getElementById("start");
stop_tracking = document.getElementById("stop");
start_tracking.addEventListener("click", startTracking);
stop_tracking.addEventListener("click", stopTracking);
*/








if (navigator.mediaDevices) {
    console.log('getUserMedia supported.');
    navigator.mediaDevices.getUserMedia ({audio: true, video: false})
    .then(function(stream) {
        video_frame.srcObject = stream;
        video_frame.onloadedmetadata = function(e) {
           video_frame.play();
            video_frame.muted = true;
            video_frame.style.display = 'none';
            




  // The audio context and the analyser pull the audio data and
      // allow us to store it in an array of frequency volumes
      audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      analyser = audioCtx.createAnalyser();
      
      // Our source is our WebRTC Audio stream
      source = audioCtx.createMediaStreamSource( stream );
      source.connect(analyser);
      
      analyser.fftSize = 2048;
      bufferLength = analyser.frequencyBinCount;
      
      // We will pull the audio data for each bar from this array
      dataArray = new Uint8Array( bufferLength );
      
      
      
      
      
      /*
      
      
 audioCtx = new (window.AudioContext || window.webkitAudioContext)();
 analyser = audioCtx.createAnalyser();

     analyser.fftSize = 2048;
    var bufferLength = analyser.fftSize;
    console.log(bufferLength);
    var dataArray = new Uint8Array(bufferLength);
           frequencyData = new Uint8Array(analyser.frequencyBinCount);
   */
          frequencyData = new Uint8Array( bufferLength );



/*

analyser.fftSize = 2048;
 bufferLength = analyser.frequencyBinCount;
console.log(bufferLength);
 dataArray = new Uint8Array(bufferLength);
*/
 ////////// frequencyData = new Uint8Array(analyser.frequencyBinCount);

//console.log(dataArray);
///console.log(bufferLength);
	
           success_stream(stream);  
            
            
        };

///
//
////

 
//

//

 
			 //////  this.frequencyData = new Uint8Array(analyser.frequencyBinCount);

 

/////
///
/////
 

    })
    .catch(function(err) {
        console.log('The following gUM error occured: ' + err);
    });
} else {
   console.log('getUserMedia not supported on your browser!');
}




 

// start tracking
tracking.ColorTracker.registerColor('col1', function(r, g, b){
    var r_low = 140, r_high = 200, g_low = 20, g_high = 80, b_low = 10, b_high = 100;
    if(r > r_low && r < r_high && g > g_low && g < g_high && b > b_low && b < b_high){
        return true;
    }
    return false;
});
var myTracker = new tracking.ColorTracker(['col1','yellow']);


////myTracker.on("track", color_tracking_handler);
///var mt = tracking.track('#myVideo', myTracker);
  
  
///   mt.run();



	//Init 3D
/////	scene = new THREE.Scene();

/////// var container = document.getElementById( "container" );

//// renderer = new THREE.WebGLRenderer({antialias:true, preserveDrawingBuffer:false }); 
     
renderer = new THREE.WebGLRenderer({antialias:true, preserveDrawingBuffer:true }); 


	renderer.setSize( width, height );
 	 renderer.setClearColor( 0xf0f0f0 );
			///	renderer.setPixelRatio( window.devicePixelRatio );
			///	renderer.setSize( window.innerWidth, window.innerHeight );
/////////renderer.sortObjects = false;
	containerb = document.getElementById("containerb");
	 containerb.appendChild( renderer.domElement );
			
		 


 
////////////////////////////////////////////////////////////////
////// controls 
////////////////////////////////////////////////////////////////
 

/////////////////
//// camera
///////////////
 	camera = new THREE.PerspectiveCamera(fov, window.innerWidth / window.innerHeight, .5, 5000);
 	camera.target = new THREE.Vector3(0, 0, 0);
	scene.add(camera);
	camera.position.z = 1566;
	camera.position.y = -26;
////////////

 
 	world3D = new THREE.Object3D();

 


	scene.add(world3D);
			var gui = new dat.GUI();

////////////////////////////////////////////////////////////////
////// controls 
////////////////////////////////////////////////////////////////
 
  //// //////// var controls = new THREE.VRControls(camera);

 

var controls = new THREE.OrbitControls(camera);


/////////// var controls = new THREE.TrackballControls( camera );


 
 

				controls.rotateSpeed = 2.0;
				controls.zoomSpeed = 1.2;
				controls.panSpeed = 0.8;

			
				controls.noPan = false;






 
	this.screen = { left: 0, top: 0, width: 0, height: 0 };

 
	controls.noRotate = false;
	controls.noZoom = false;
	controls.noPan = false;

	controls.staticMoving = false;
	controls.dynamicDampingFactor = 0.2;

 
	controls.keys = [ 65 /*A*/, 83 /*S*/, 68 /*D*/ ];
	controls.staticMoving = false;






// Apply VR stereo rendering to renderer.
var effect = new THREE.VREffect(renderer);
effect.setSize(window.innerWidth, window.innerHeight);
 
 
  controls.maxPolarAngle = 1*Math.PI/1.55; 
 controls.noZoom = false;

	controls.minDistance = 0;
	controls.maxDistance = 2166; 
 	 	controls.damping = .3;
///// controls.target.copy( vector );
  
 
// Create a VR manager helper to enter and exit VR mode.
var params = {
  hideButton: false, // Default: false.
  isUndistorted: false // Default: false.
};
var manager = new WebVRManager(renderer, effect, params);






 
 
  
////////


 
 
 
 
////////////////////////////////////////////////////////////////
 ////////////////////////////////////////////////////////////////
 ////////
/////
//
 ////
////
 ////////////
  
  	lmholder = new THREE.Object3D();

scene.add(lmholder);

 
//////////////////////////////////////////
    //   
//////////////////////////////////////////
var cube_geometry = new THREE.BoxGeometry( 4,-162,2 );
 

////////////////
//// taken out 6/8/18      var cube_material = new THREE.MeshBasicMaterial( { color: 0x6be32e,wireframe: true,wireframeLinewidth:.5, side: THREE.DoubleSide  } );



var cube_material = new THREE.MeshBasicMaterial( { color: 0x111111,wireframe: true,wireframeLinewidth:.5, side: THREE.DoubleSide  } );

///////	 	var cube_material = new THREE.MeshBasicMaterial( { color: Math.random() * 0xffffff, wireframe: true } );
//////var cube_material = new THREE.MeshBasicMaterial( {wireframe:true,wireframeLinewidth:.1, color: Math.random() * 0xffffff} );
var cube_fac = window.innerWidth;
var cube_scale = 0.025;
var cube_holder = new THREE.Object3D();
for(var i=0;i<126;i++){
	  var x = -(window.innerWidth/2) + (window.innerWidth/56)*i;
	  var y = -936;
	  var z = -60;
  var cube = new THREE.Mesh( cube_geometry, cube_material );
 cube.scale.set(cube_scale,cube_scale,cube_scale);
  cube.position.x = x-(window.innerWidth/2);
  cube.position.y = y;
  cube.position.z = z;
  cube.receiveShadow = true;
  cube.castShadow = true;
  cube_holder.add(cube);
}
world3D.add( cube_holder );

  cube_holder.position.z = -160;

  cube_holder.position.x= x-(window.innerWidth*1.85);
  cube_holder.position.y = 346;

/////////////////



//////////////////////////////////////////
var cube_geometryB = new THREE.BoxGeometry( 1,-466,2);

 
var cube_materialBB = new THREE.MeshBasicMaterial( {wireframe:true,wireframeLinewidth:.5, color: Math.random() * 0xffffff} );

//// var cube_materialB = new THREE.MeshBasicMaterial( { color: 0xcd441b, wireframe: true, opacity:.6 } );


////// var cube_materialB = new THREE.MeshBasicMaterial( {wireframe:true,wireframeLinewidth:.5, color: Math.random() * 0xffffff} );

 	
//////var cube_materialB = new THREE.MeshBasicMaterial( {wireframe:true,wireframeLinewidth:.5, color: 0x83d1fd} );


var cube_materialB = new THREE.MeshBasicMaterial( { wireframe:true,wireframeLinewidth:.5, color: 0x000000 } );


var cube_facB = window.innerWidth;
var cube_scaleB = 0.0025;
var cube_holderB = new THREE.Object3D();
for(var i=0;i<128;i++){
	  var x = -window.innerWidth + (window.innerWidth/60)*i;
	  var y = -636;
	  var z = 30;
  var cubeB = new THREE.Mesh( cube_geometryB, cube_materialB );
 cubeB.scale.set(cube_scaleB,cube_scaleB,cube_scaleB);
  cubeB.position.x = x-196;
  cubeB.position.y = y;
  cubeB.position.z = z;
   cube_holderB.add(cubeB);
}


////////////////
//// taken out 6/8/18      

world3D.add( cube_holderB );
  cube_holderB.position.z = -246;
 
  cube_holderB.position.x = x-(window.innerWidth);
 /// cube_holderB.position.x = -696;
  cube_holderB.position.y = 96;

//////////////////////////////////////////






/////////////////
///////////////////////////////////////////////////////
////////////////////////////////////////////////////////



//////////////////////////////////////////
    //   
//////////////////////////////////////////
var cube_geometryZ = new THREE.BoxGeometry( 125,-436,1200 );

 


////var cube_materialZ = new THREE.MeshBasicMaterial( {wireframe:true,wireframeLinewidth:.5, color: /////Math.random() * 0xffffff} );

var cube_materialZ = new THREE.MeshBasicMaterial( {wireframe:true,wireframeLinewidth:5, color: Math.random() * 0xffffff} );

var cube_facZ = window.innerWidth;
var cube_scaleZ = 0.0025;
var cubeZ_holder = new THREE.Object3D();
for(var i=0;i<128;i++){
//////////	  var x = -window.innerWidth/1.95 + (window.innerWidth/48)*i;
	  var x = -window.innerWidth + (window.innerWidth/48)*i;
	  var y = -636;
	  var z = 366;
  var cubeZ = new THREE.Mesh( cube_geometryZ, cube_materialZ );
 cubeZ.scale.set(cube_scaleZ,cube_scaleZ,cube_scaleZ);
  cubeZ.position.x = x-(window.innerWidth);
  cubeZ.position.y = y;
  cubeZ.position.z = z;
  cubeZ.receiveShadow = true;
  cubeZ.castShadow = true;
  cubeZ_holder.add(cubeZ);
}

 ////////world3D.add( cubeZ_holder );

	 
		
///////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////
/*lineholder.position.set(-636,-480,-300);
lineholder.scale.set(8,8,1);

 world3D.add( lineholder );
*/

///////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////
	

 



var hairmap =  photoloader.load( "/stories/wildbeast/images/hair.png" );
hairmap.anisotropy = 4
//hairmap.repeat.set( 0.998, 0.998 )
///hairmap.offset.set( 0.001, 0.001 )
hairmap.wrapS = hairmap.wrapT = THREE.RepeatWrapping
/////////hairmap.format = THREE.RGBFormat





 	// lights

 		var dirLight = new THREE.DirectionalLight( 0xffffff, 0.05 );
 		dirLight.position.set( 0, 1000, -1000 ).normalize();
	 	 world3D.add( dirLight );

 ////////////	dirLight.color.setHSL( 0.1, 0.7, 0.5 );




  

	



 	
 
 	 /////////////
	// VIDEO V //
   /////////////
 
 var videoV = document.getElementById( 'myVideoV' );
 
  



	/////videoV.playsinline = true;
	videoV.autoplay = true;
	videoV.loop = true;
videoV.width = 2048;
videoV.height = 1024;
videoV.src='g2.mp4';
 videoTextureV = new THREE.Texture(videoV);
 
/////  videoTextureV.minFilter = THREE.NearestFilter;




 
 ///
 ////
 /////
 
  
 

 videoTextureV = new THREE.Texture(videoV);
  videoTextureV.minFilter = THREE.LinearFilter;



   
		
/* took out 6/8/18
videoTexture = new THREE.Texture(video_frame);
*/


 //// videoTexture = new THREE.ImageUtils.loadTexture('image.jpg') ;
 
videoTextureV.generateMipmaps = false;
videoTextureV.magFilter = THREE.LinearFilter;
videoTextureV.minFilter = THREE.LinearFilter;

 /////videoTexture.minFilter = THREE.LinearFilter;

	
	
 var skyMaterial = new THREE.MeshBasicMaterial( {
 /////// 	map: videoTexture,
 /////// 	map: new THREE.TextureLoader().load( "/stories/grand/grand1.jpg" ),
	 map: new THREE.TextureLoader().load( "greatbasin.jpg" ),
	 
 	color: 0xffffff,
 	side: THREE.DoubleSide
 } );


 
  
 
// var skyMaterial = new THREE.MeshBasicMaterial( {
// 	map: videoTexture,
// 	/////map: new THREE.TextureLoader().load( "../../../environments/04valencia01.jpg" ),
// 	color: 0xffffff,
/// 	side: THREE.DoubleSide
///// } );

				
	

 //////var skyMaterial = new THREE.MeshBasicMaterial( { map : videoTextureV, color: 0xffffff, side: THREE.DoubleSide  } );

				
	
					var skyBoxgeom = new THREE.SphereGeometry( 2666, 95, 65 );
				skyBoxgeom.applyMatrix( new THREE.Matrix4().makeScale( -1, 1, 1 ) );



aSkyDome = new THREE.Mesh(skyBoxgeom, skyMaterial);  
 aSkyDome.scale.set(-1, 1, 1);  
///////skyBox.eulerOrder = 'XZY';  
////////skyBox.renderDepth = 500.0;  
 	    aSkyDome.position.y = 366;
 	    aSkyDome.rotation.y = 1.4;
 	    aSkyDome.rotation.z = -.006;
////////scene.add(skyBox);  
aSkyDome.rotation.x = Math.PI / .0001;

  	world3D.add(aSkyDome);


	 ///	aSkyDome.castShadow	= false;
////	aSkyDome.receiveShadow	= true;
	



///////
//////
///////
		

			

	//add mirror plane

	//add mirror plane
var geometry = new THREE.PlaneGeometry(2048, 1024, canvasWidth, canvasHeight);
geometry.dynamic = true;

	meshMaterial = new THREE.MeshBasicMaterial({
		opacity: 1,
		map: videoTextureV
	});
	
	vidmeshMaterial = new THREE.MeshBasicMaterial({
 		opacity: 1,
		map: videoTextureV
	});

///
/////

 materiala = new THREE.MeshBasicMaterial( {wireframe: false, color: Math.random() * 0xffffff, opacity: .2
 });

 

 materialag = new THREE.MeshPhongMaterial( {wireframe: false, color: Math.random() * 0xffffff, opacity: .8
 });

 

 immaterialagg = new THREE.MeshBasicMaterial( {wireframe: false, opacity: .8,map: videoTextureV
 });


 immaterialaggg = new THREE.MeshBasicMaterial( {wireframe: false, color: 0x8b6e6, opacity: .8
 });

 immaterialagggm = new THREE.MeshBasicMaterial( {wireframe: false, color: 0x111111,	 opacity: 1, map: new THREE.TextureLoader().load( "greatbasin.jpg" )
 });
 immaterialaggga = new THREE.MeshBasicMaterial( {wireframe: false, color: 0xffffff,	 map: new THREE.TextureLoader().load( "greatbasin.jpg" ), opacity: .8
 });
 immaterialagggaa = new THREE.MeshBasicMaterial( {wireframe: false, color: 0xffffff,	 map: videoTextureV, opacity: .8
 });


 immaterialag = new THREE.MeshBasicMaterial( {wireframe: false, color: Math.random() * 0xffffff, opacity: .8
 });

 
 

var vidvidmateriala = new THREE.MeshBasicMaterial( {wireframe: false, color:0xffffff, opacity: .2
 });

var vidmateriala = new THREE.MeshBasicMaterial( {wireframe: false, color:0x00e700, opacity: .2
 });

/// var material = new THREE.MeshBasicMaterial( {  map : videoTextureV });

 var skyMaterial = new THREE.MeshBasicMaterial( { map : videoTextureV, color: 0xffffff, side: THREE.DoubleSide  } );

///////var materiala = new THREE.MeshBasicMaterial( {wireframe: false, color:0x4b8ad8, opacity: .2
/////// });

    	         scene.fog = new THREE.Fog(main_color, 3366, 5666);
   ///// orig 3.28/18         scene.fog = new THREE.Fog(main_color, 966, 2300);

 
//////
 var geometryg = new THREE.PlaneGeometry(2048, 1024, canvasWidth, canvasHeight);
 
 
 
 
 		
	/////// ground plane
 	//////
 	
   
		 Ground = new THREE.PlaneBufferGeometry(5000, 5000, canvasWidth, canvasHeight);
		var Groundm = new THREE.Mesh(Ground, immaterialagggm);

Ground.dynamic = true;
		Groundm.rotation.x = - Math.PI * 0.5;
		Groundm.position.y = - 416;
 ////////////////////////////////////	 	world3D.add(Groundm);

	
	
		/////	 vidmirror = new THREE.Mesh(geometry, immaterialagg);

 
	 vidmirror = new THREE.Mesh(geometry, immaterialagggm);
/////	var vidmirror = new THREE.Mesh(geometry, vidmeshMaterial);
/////////////////////////////// 	world3D.add(vidmirror);
vidmirror.material.side = THREE.DoubleSide;
 vidmirror.position.z = -202;
  vidmirror.scale.set(1,1,1);


////////// vidmirrorg = new THREE.Mesh(geometryg, immaterialagggaa);

 vidmirrorg = new THREE.Mesh(geometry, vidmeshMaterial);
  	world3D.add(vidmirrorg);
vidmirrorg.material.side = THREE.DoubleSide;
  vidmirrorg.position.z = -216;
  vidmirrorg.scale.set(1,1,1);
/////////vidmirrorg.rotation.y = Math.PI / .5;




 /*

/////	var vidmirrorg = new THREE.Mesh(geometry, materialag);
 	var vidmirrorg = new THREE.Mesh(geometry, vidmeshMaterial);
  	world3D.add(vidmirrorg);
vidmirrorg.material.side = THREE.DoubleSide;
 vidmirrorg.position.z = -162;
  vidmirrorg.scale.set(-1,1,1.02);


////
///
 
 
  


	var mirror = new THREE.Mesh(geometry, vidmateriala);
 world3D.add(mirror);
mirror.position.z = -236;
mirror.scale.set(-1,1,2);


mirror.material.side = THREE.DoubleSide;
mirror.position.z = -236;
mirror.position.x = -6;
mirror.position.y = -6;
mirror.scale.set(-1,1,2);
*/
	//add wireframe plane
	wireMaterial = new THREE.MeshBasicMaterial({
 ///////////////////////////////// map:videoTextureV,
	opacity: .1,
	///// 	color:  0x8ba7b6,
		wireframe: true,
				wireframeLinewidth:.5,

		blending: THREE.AdditiveBlending,
		transparent: true
	});

	//add wireframe plane
	wireMaterialBK = new THREE.MeshLambertMaterial({
		opacity: 1,
		color: 0xaaaaaa,
		wireframe: true,
				wireframeLinewidth:.5,

		blending: THREE.AdditiveBlending,
		transparent: true
	});



	//add wireframe plane
	vidwireMaterial = new THREE.MeshBasicMaterial({
		opacity: 1,
		color: 0x009aff,
		wireframe: true,
				wireframeLinewidth:5,

		blending: THREE.AdditiveBlending,
		transparent: true
	});
 



	var wiremirror = new THREE.Mesh(geometry, wireMaterial);
 /////////////////////////	world3D.add(wiremirror);
	wiremirror.position.z = -208;
wiremirror.scale.set(1,1,1.1);




	var wiremirrorg = new THREE.Mesh(geometryg, wireMaterial);
////  	world3D.add(wiremirrorg);
 wiremirrorg.position.z = -200;
wiremirrorg.scale.set(-1,1,1);



	var vidwiremirror = new THREE.Mesh(geometry, vidwireMaterial);
////////
//////
/////////////	world3D.add(vidwiremirror);
////////
//////
/////////////	

	vidwiremirror.position.z = -205;
vidwiremirror.scale.set(-1,1,1.3);
vidwiremirror.position.x = -6;
vidwiremirror.position.y = -6;














	
 
	var vidvidmirror = new THREE.Mesh(geometry, vidvidmateriala);
 //	world3D.add(vidvidmirror);
vidvidmirror.material.side = THREE.DoubleSide;
vidvidmirror.position.z = -218;
vidwiremirror.position.y = 6;
 vidvidmirror.scale.set(-1,1,1.3);

 
	//add wireframe plane
	vidvidwireMaterial = new THREE.MeshBasicMaterial({
		opacity: 1,
		color: 0xffffff,
		wireframe: true,
				wireframeLinewidth:2,

		blending: THREE.AdditiveBlending,
		transparent: true
	});
	var vidvidwiremirror = new THREE.Mesh(geometry, vidvidwireMaterial);

////////
//////
/////////////	world3D.add(vidvidwiremirror);
	vidvidwiremirror.position.z = -187;
vidwiremirror.position.y = 6;
 vidvidwiremirror.scale.set(-1,1,2);
//////////
///////
///////////
 

 
// set canvas as material.map (this could be done to any map, bump, displacement etc.)
///  immaterialag.map = new THREE.Texture( canvas );
// need to flag the map as needing updating.
/////	immaterialag.map.needsUpdate = true;





// create the sphere geometrysphere
///// sphereGeometry = new THREE.SphereGeometry( 111, 60, 30); 
 
 sphereGeometry = new THREE.SphereGeometry(6, 15, 15);
 
 
 
  // create the sphere's material
/////////sphereMaterial = new THREE.MeshLambertMaterial({ color : 0xEEEEEE, map : immaterialag, shininess : 200, shading : THREE.SmoothShading});
// now create the sphere and then
// declare its geometry to be dynamic
// so we can update it later on

/*meshwa = new THREE.Mesh(sphereGeometry, immaterialag);
meshwa.geometry.dynamic = true;
*/



 //////////
 ///////////
 /// wolves

/*

     loader.load('/stories/wolf.json', function(wolfGeometry) {
        meshwa = new THREE.Mesh(wolfGeometry,new THREE.MeshPhongMaterial({
		opacity: 1,
		color: Math.random() * 0xffffff,
 bumpMap : this.hairmap,
  bumpScale  :  4.75,
  shading: THREE.FlatShading, 
  side: THREE.DoubleSide,
		map: this.hairmap
	} ));
	    });
	
	  */
 var meshwa = null;
     var loader = new THREE.JSONLoader(); 










    loader.load('/stories/wolf.json', function(wolfGeometry) {
        meshwa = new THREE.Mesh(wolfGeometry,immaterialagg);
    world3D.add(meshwa);
  
    //////    meshwa = new THREE.Mesh(sphereGeometry,immaterialaggg);

//////
////
////////////////
meshwa.scale.x = meshwa.scale.y = meshwa.scale.z = (Math.random()*236+66);
 ////
 ///
 /////
        /////// meshw.translation = THREE.GeometryUtils.geometry.center(wolfGeometry);
    //////    ////  meshw.position.set(Math.random()*30-90,0,Math.random()*30-90);
   meshwa.position.set(1366,-466,-166);
    });

	
	
	  loader.load('/stories/wolf.json', function(wolfGeometry) {
        meshw = new THREE.Mesh(wolfGeometry,immaterialagg);
    world3D.add(meshw);
  
    //////    meshwa = new THREE.Mesh(sphereGeometry,immaterialaggg);

//////
////
////////////////
meshw.scale.x = meshw.scale.y = meshw.scale.z = (Math.random()*236+66);
 ////
 ///
 /////
        /////// meshw.translation = THREE.GeometryUtils.geometry.center(wolfGeometry);
    //////    ////  meshw.position.set(Math.random()*30-90,0,Math.random()*30-90);
   meshw.position.set(-1366,-466,-166);
    });

	
	
	
	
	
	 /* */
    });


/*
     loader.load('/stories/wolf.json', function(wolfGeometry) {
        meshwa = new THREE.Mesh(wolfGeometry,immaterialag);
	    });
	////wolfGeometry.dynamic=true;



	
	
      loader.load('/stories/owl3.json', function(owl) {
        meshwww = new THREE.Mesh(owl,immaterialag);
     });

	
*/

 
			
	init();		
			
	
 

 		

function init() {

	// stop the user getting a text cursor
	document.onselectstart = function() {
		return false;
	};

	//init control panel
	params = new WCMParams();
 
	
	
	

	
	
		////////parsePermalink();
		//////THREE.ImageUtils.crossOrigin = 'anonymous';
		THREE.ImageUtils.crossOrigin = '';
/*
		var canvas = document.createElement( 'canvas' );
/////		 canvas.width = canvas.height = vertsPerTile;
		 contextcontext = canvas.getContext( '2d' );
 	canvas.style.display = 'none';
		
	*/



	// geometry
	var llgeometry = new THREE.BufferGeometry();

	// attributes
	var llpositions = new Float32Array( MAX_POINTS * 3 ); // 3 vertices per point
	llgeometry.addAttribute( 'position', new THREE.BufferAttribute( llpositions, 3 ) );

	// drawcalls
	drawCount = 2; // draw the first 2 points, only
	llgeometry.setDrawRange( 0, drawCount );

	// material
	var llmaterial = new THREE.LineBasicMaterial( { color: 0xff0000, linewidth: 22 } );

	// line
	llline = new THREE.Line( llgeometry,  llmaterial );
	

/*

 
	//init vidCanvas - used to analyze the video pixels
	*/


	vidCanvas = document.createElement('canvas');


////////	container.appendChild(vidCanvas);
/////////	vidCanvas.style.position = 'absolute';


	ctxx = vidCanvas.getContext('2d');

	vidCanvas.style.display = 'none';


	/*
	
		
		
		
			
 
 


 
	//init lineCanvas - used to analyze the video pixels


 	lineCanvas = document.createElement('canvas');
 

////////	container.appendChild(vidCanvas);
/////////	vidCanvas.style.position = 'absolute';


 	linectxx = lineCanvas.getContext('2d');

 lineCanvas.style.display = 'none';


 ///////		document.body.appendChild(lineCanvas);
		







////////////
///////wolf container
 //////////////


var meshww = null;
     var loader = new THREE.JSONLoader();
    loader.load('/stories/phillyradness/bunny.json', function(bunny) {
        meshww = new THREE.Mesh(bunny,wireMaterial);
        meshww.scale.x = meshww.scale.y = meshww.scale.z = 8;
         meshww.position.z = (Math.random()*-60-33);
         meshww.position.y = -316;
        meshww.position.x=(Math.random()*300-6);
        /////// meshww.translation = THREE.GeometryUtils.geometry.center(wolfGeometry);
      ////  meshww.position.set(Math.random()*30-90,0,Math.random()*30-90);
    ////// meshww.position.set(66,60,166);
     ///  meshww.position.x.set(6);
//////   scene.add(meshww);
//// 	world3D.add(meshww);
    });


////////////
///////wolf container
 //////////////
 
	*/

 ///////////////////
 ///////////////////
 

 
 ///////////////////
 ///////////////////
 
 
var pradmesh = new THREE.Mesh(pradgeo, pradmat);

/////////////////////// world3D.add(pradmesh);
pradmesh.material.side = THREE.DoubleSide;
pradmesh.position.y = -2186;
pradmesh.position.z = 0;
pradmesh.rotation.x = Math.PI / 2;
pradmesh.rotation.z = Math.PI / -2;
pradmesh.scale.set(-6,6,6);



 ///////////////////
 ///////////////////
 
  




 
 	
 
 	 ocean = new THREE.Mesh(geometry, materiala);

 //////	world3D.add(ocean);
ocean.material.side = THREE.DoubleSide;
ocean.position.y = -726;
ocean.position.z = 366;
ocean.rotation.x = Math.PI / 2;
ocean.scale.set(-1,1,-1);


	//add wireframe plane
	wireMaterialal = new THREE.MeshBasicMaterial({
		opacity: .6,
		color: 0x4b8ad8,
		wireframe: true,
 	wireframeLinewidth:.5,

		blending: THREE.AdditiveBlending,
		transparent: true 
	});
 


	//add wireframe plane
	wireMaterialaly = new THREE.MeshBasicMaterial({
		opacity: .1,
		color: 0x18151c,
		wireframe: true,
 	wireframeLinewidth:.5,

		blending: THREE.AdditiveBlending,
		transparent: true 
	});
 
 	var oceanframe = new THREE.Mesh(geometry, wireMaterialal);

////// world3D.add(oceanframe);
oceanframe.material.side = THREE.DoubleSide;
oceanframe.position.y = -720;
oceanframe.position.z = 366;
oceanframe.rotation.x = Math.PI / 2;
oceanframe.scale.set(-1,1,-1);









 
	
 


	// add Stats
	 
			//////////////////////////////////////////
    //   Resize
//////////////////////////////////////////
window.onresize = function(){
  canvas_height = window.innerHeight;
  canvas_width = window.innerWidth;
  camera.aspect = canvas_width / canvas_height;
  camera.updateProjectionMatrix();
  renderer.setSize( canvas_width, canvas_height );
}



			
			
			
			
    
 

 				var sphereZZ = new THREE.SphereGeometry( 6, 15, 36 );
 				var sphereZZZ = new THREE.SphereGeometry( 36, 15, 36 );

 
				// sound spheres
   // sphereZZ.computeFaceNormals();
  ////  sphereZZ.computeVertexNormals();


			///	var mesh1 = new THREE.Mesh( sphereZZ, materialWWW );
			///	mesh1.position.set( 0, -555, 20 );
			////	this.scene.add( mesh1 );
 
 


 				  //  sound1.loop = true;

			//	sound1.setRefDistance( 300 );
			///	this.mesh1.add( sound2 );

				//
				
				 ///   sphereZZZ.computeFaceNormals();
  ///  sphereZZZ.computeVertexNormals();

	
 

 
 
///////////////////////////
/// sky interactive shapes
///////////////////////////

 var geometrygeogeo = new THREE.SphereGeometry( 63, 5, 5 );
            var materialgeogeo;

			            var rowgeo, columngeo;
            cubeContainergeo = new THREE.Object3D();

            for(row = -5; row < 5; row++){
 for (column = -5; column < 5; column++) {

     materialgeogeo = new THREE.MeshBasicMaterial( {wireframe:true,wireframeLinewidth:.1, color: Math.random() * 0xffffff} );
cubegeogeo = new THREE.Mesh( geometrygeogeo, materialgeogeo );

 /////////////////         cubegeogeo = new THREE.Mesh( geometrygeogeo, meshMaterial );


///	var object = new THREE.Mesh( geometry, new THREE.MeshLambertMaterial( { color: Math.random() * 0xffffff } ) );

 cubegeogeo.position.x = Math.random() * -3660 - 60;
 cubegeogeo.position.y = Math.random() * -110 - 100;
 cubegeogeo.position.z = Math.random() * -130 - 100;

 cubegeogeo.rotation.x = Math.random() * 2 * Math.PI;
 cubegeogeo.rotation.y = Math.random() * 2 * Math.PI;
 cubegeogeo.rotation.z = Math.random() * 2 * Math.PI;

 
 cubegeogeo.castShadow = true;
 cubegeogeo.receiveShadow = true;

 cubeContainergeo.add( cubegeogeo );

 cubesgeo.push( cubegeogeo );
 }
 }
  
  		cubeContainergeo.scale.set(1,1,1)
             cubeContainergeo.position.set(1666,-536,-136)
 /////        world3D.add(cubeContainergeo);


////////
///////
/// 



  

////
///
////

 
        var sphereContainer = new THREE.Object3D();
     world3D.add(sphereContainer);
      sphereContainer.position.set(-1840,-753,-1650);
     /// sphereContainer.rotation.set(0,0,-.4);
      sphereContainer.scale.set(1,1,1);




 
      var sphere;
         var spheremesh = new THREE.SphereGeometry(16,3,3);
 
            for (var i = 0; i < 66; i++) {
       sphere = new THREE.Mesh( spheremesh, 
        new THREE.MeshBasicMaterial( {wireframe:true,wireframeLinewidth:.5} ));
        sphere.position.set(Math.random()*3680-0,Math.random()*366-6,Math.random()*3200-0);
        
        
        					sphere.scale.x = Math.random() * .1 - .01;
					sphere.scale.y = Math.random() * .1 - .01;
					sphere.scale.z = Math.random() * .1 - .01;
					sphere.rotation.x = Math.random() * 2 * Math.PI;
					sphere.rotation.y = Math.random() * 2 * Math.PI;
					sphere.rotation.z = Math.random() * 2 * Math.PI;

        sphereContainer.add(sphere);
					sphereo.push( sphere );

////
}
 
		 

////



 
  
 
 /////////////////////////////
 ////////////////////////////
 
 	///////////////
 			//// also a
 			///  speech 
 			//   component
 			/// this is off
 			//// for now
 			//// can be 
 			//// activated
 			///// for gallery
 			///// admin
 
  
 ////////////////////////////
 /////////////////////////
 
 
 
 



	 
 
/////////////////////////////////    setInterval(moveBox, 100);

 
 





/* Textures */
THREE.crossOrigin = "";
var bmap =  new THREE.TextureLoader().load("/stories/moon_SPEC.png");
var smap =  new THREE.TextureLoader().load("/stories/moon_COLOR.png");





 /* Lightening */
var light = new THREE.PointLight( new THREE.Color("rgb(255,70,3)"), 2.5);
var light2 = new THREE.PointLight( new THREE.Color("rgb(245,189,37)"), 4);
light.position.set( 0, 1300, -1000 );
light2.position.set( 50, -150, 300 );



/* Old Wall */
var oldMaterial = new THREE.MeshPhongMaterial({
  color      :  new THREE.Color("rgb(18,47,145)"),

  emissive   :  new THREE.Color("rgb(7,3,5)"),
    specular   :  new THREE.Color("rgb(153,106,50)"),


 ///// specular   :  new THREE.Color("rgb(223,215,129)"),
  shininess  :  0,
  bumpMap    :  bmap,
  map        :  smap,
  bumpScale  :  1,
});
oldWall = new THREE.Mesh( new THREE.SphereGeometry(166,62,38), oldMaterial );

oldWall.position.set(0,796,112);
oldWall.rotation.y = 1.4;
oldWall.rotation.z = .2;
oldWall.rotation.x = -2.4;

/* Scene */
////  world3D.add( oldWall );
// uf.scene.add ( light );
 world3D.add ( light2 );

 
 
				
				

 
  

///////////////////////////////////


	/////	clock.start();
		
		
		



 ////////////////	document.body.addEventListener('mousedown', handlerer, false )    
			

/// document.body.addEventListener ('mouseup', handlerr, false );
///document.body.addEventListener('mousemove', handler, false )    
///  	document.body.addEventListener('mousedown', handlerer, false )    

 



	
 	////document.addEventListener( 'mousemove', onMouseMove, false );

				//

 	onResize();


  
 




	
//////	var lastRender = 0;

	
}
	
	
	
//////
////
////


function createCurve(rect) {

	var s = new THREE.ConstantSpline();
	var rMin = 5;
	var rMax = 10;
	
///// var origin = new THREE.Vector3( rect.x, rect.y, rect.height);


	var origin = new THREE.Vector3( Maf.randomInRange( -rMin, rMin ), Maf.randomInRange( -rMin, rMin ), Maf.randomInRange( -rMin, rMin ) );


	s.inc = .001;
	s.p0 = new THREE.Vector3( .5 - Math.random(), .5 - Math.random(), .5 - Math.random() );
	s.p0.set( 0, 0, 0 );
	////	s.p0.set( rect.x, rect.y, rect.height );

	s.p1 = s.p0.clone().add( new THREE.Vector3( .5 - Math.random(), .5 - Math.random(), .5 - Math.random() ) );
	s.p2 = s.p1.clone().add( new THREE.Vector3( .5 - Math.random(), .5 - Math.random(), .5 - Math.random() ) );
	s.p3 = s.p2.clone().add( new THREE.Vector3( .5 - Math.random(), .5 - Math.random(), .5 - Math.random() ) );
	s.p0.multiplyScalar( rMin + Math.random() * rMax );
	s.p1.multiplyScalar( rMin + Math.random() * rMax );
	s.p2.multiplyScalar( rMin + Math.random() * rMax );
	s.p3.multiplyScalar( rMin + Math.random() * rMax );

	s.calculate();
	var geometry = new THREE.Geometry();
	s.calculateDistances();
	//s.reticulate( { distancePerStep: .1 });
	s.reticulate( { steps: 500 } );
 	var geometry = new THREE.Geometry();

	for( var j = 0; j < s.lPoints.length - 1; j++ ) {
		geometry.vertices.push( s.lPoints[ j ].clone() );
	}

	return geometry;

}

var colors = [
	0xed6a5a,
	0xf4f1bb,
	0x9bc1bc,
	0x5ca4a9,
	0xe6ebe0,
	0xf0b67f,
	0xfe5f55,
	0xd6d1b1,
	0xc7efcf,
	0xeef5db,
	0x50514f,
	0xf25f5c,
	0xffe066,
	0x247ba0,
	0x70c1b3
];

function clearLines() {









	lines.forEach( function( l ) {
		this.scene.lmholder.remove( l );
		 this.scene.lmholder.geometry.dispose();
 this.scene.lmholder.material.dispose();

		 


	} );
	lines = [];
 
}

function makeLine( geo ) {

	var g = new MeshLine();

	switch( params.taper ) {
		case 'none': g.setGeometry( geo ); break;
		case 'linear': g.setGeometry( geo, function( p ) { return 1 - p; } ); break;
		case 'parabolic': g.setGeometry( geo, function( p ) { return 1 * Maf.parabola( p, 1 )} ); break;
		case 'wavy': g.setGeometry( geo, function( p ) { return 2 + Math.sin( 50 * p ) } ); break;
	}

	var material = new MeshLineMaterial( {
		map: strokeTexture,
		useMap: params.strokes,
		color: new THREE.Color( colors[ ~~Maf.randomInRange( 0, colors.length ) ] ),
		opacity: 1,//params.strokes ? .5 : 1,
		dashArray: new THREE.Vector2( 10, 5 ),
		resolution: resolution,
		sizeAttenuation: params.sizeAttenuation,
		lineWidth: params.lineWidth,
		near: camera.near,
		far: camera.far,
		depthWrite: false,
		depthTest: !params.strokes,
		alphaTest: params.strokes ? .5 : 0,
		transparent: true,
		side: THREE.DoubleSide
	});
	var mesh = new THREE.Mesh( g.geometry, material );
	if( params.spread || params.circles ) {
		var r = 50;
		mesh.position.set( Maf.randomInRange( -r, r ), Maf.randomInRange( -r, r ), Maf.randomInRange( -r, r ) );
		var s = 10 + 10 * Math.random();
		mesh.scale.set( s,s,s );
		mesh.rotation.set( Math.random() * 2 * Math.PI, Math.random() * 2 * Math.PI, Math.random() * 2 * Math.PI );
	}
///	world3D.add( mesh );
	//////////	clearLines();

/////////	lmholder.remove( mesh );
	lmholder.add( mesh );

	lines.push( mesh );

}



///
///
/////	




var tmpVector = new THREE.Vector3();









	
// update positions
function updatePositions(rect) {

	var llpositions = llline.geometry.attributes.position.array;

	var x = this.rect.x;
	var y = this.rect.y;
	var z = this.rect.height;
	var index = 0;

	for ( var i = 0, l = MAX_POINTS; i < l; i ++ ) {

		llpositions[ index ++ ] = x;
		llpositions[ index ++ ] = y;
		llpositions[ index ++ ] = z;

		x += ( Math.random() - 0.5 ) * 30;
		y += ( Math.random() - 0.5 ) * 30;
		z += ( Math.random() - 0.5 ) * 90;

	}

}




	function update() {
		if( params.autoUpdate ) {
			clearLines();
			////createLines();
		}
	}

 
	//init control panel

 //////////	gui.add(params, 'zoom', 0.1, 5).name('Zoom').onChange(onParamsChange);
 
 ///
 /*
 
 	gui.add( params, 'curves' ).onChange( update );
	gui.add( params, 'circles' ).onChange( update );
	gui.add( params, 'amount', 1, 1000 ).onChange( update );
	gui.add( params, 'lineWidth', 1, 20 ).onChange( update );
	gui.add( params, 'taper', [ 'none', 'linear', 'parabolic', 'wavy' ] ).onChange( update );
	gui.add( params, 'strokes' ).onChange( update );
	gui.add( params, 'sizeAttenuation' ).onChange( update );
	gui.add( params, 'autoUpdate' ).onChange( update );
	gui.add( params, 'update' );
	gui.add( params, 'animateWidth' );
	gui.add( params, 'spread' );
	gui.add( params, 'autoRotate' );
    gui.add( params, 'animateVisibility' );

 	gui.add(params, 'contrast', 1, 5).name('Contrast').onChange(onParamsChange);
 	gui.add(params, 'saturation', 0, 5).name('Saturation').onChange(onParamsChange);

*/
	gui.add(params, 'zDepth', 0, 1000).name('Z Depth');
	gui.add(params, 'noiseStrength', 0, 600).name('Noise Strength');
	gui.add(params, 'noiseSpeed', 0, 0.05).name('Noise Speed');
	gui.add(params, 'noiseScale', 0, 0.1).name('Noise Scale');
	gui.add(params, 'invertZ').name('Invert Z');
///////////// 	gui.add(params, 'novid').name('video mirror').onChange(noVidski);
//////// gui.add(this, 'saveImage').name('Snapshot');
 
 /////	gui.add(params, 'oceancolor', 0, 2).name('Ocean Color').onChange(onParamsChange);
////// 	gui.add(params, 'mOpac', 0, 1).name('Mesh Opacity').onChange(onParamsChange);
	gui.add(params, 'wfOpac', 0, 1).name('Grid Opacity').onChange(onParamsChange);

  gui.addColor(params,'gridcolor').name('Grid Color').onChange(onParamsChange);
  gui.addColor(params,'oceancolor').name('Back Color').onChange(onParamsChange);
  gui.addColor(params,'frontcolor').name('Front Color').onChange(onParamsChange);

  gui.addColor(params,'cubeco').name('soiundblocks Color').onChange(onParamsChange);
  gui.addColor(params,'cubeBco').name('soundblocks2 Color').onChange(onParamsChange);
//////  gui.addColor(params,'cubeZco').name('floorlines Color').onChange(onParamsChange);
/////gui.add(params, 'slideshow').name('background slideshow').onChange(onParamsChange);

 	gui.add(params, 'noocean').name('cursor').onChange(onParamsChange);
	
 ///	gui.add(params, 'addterrain').name('Add Terrain');

////	gui.add(params, 'mirrorvideo', 0, 1).name('Mirror Video').onChange(onParamsChange);;

 
 //////	
//////	gui.add(params, 'novid', 0, 1).name('Video').onChange(onParamsChange);




		gui.close();

     
 

// params for dat.gui

function WCMParams() {

	this.curves = false;
	this.circles = true;
	this.amount = 1;
	this.lineWidth = 3;
	this.taper = 'none';
	this.strokes = false;
	this.sizeAttenuation = false;
	this.animateWidth = false;
	this.spread = false;
	this.autoRotate = false;
	this.autoUpdate = true;
    this.animateVisibility=false;
	this.update = function() {
		clearLines();
	/////	createLines();
	}
	
	
	this.zoom = 1;
	this.mOpac = 1;
	this.wfOpac = .1;
	this.contrast = 1.2;
	this.saturation = 1.2;
	this.invertZ = false;
	this.zDepth = 124;
	this.noiseStrength = 20;
	this.noiseScale = 0.013;
	this.noiseSpeed = 0.03;
////	 this.saveImage = function() {};
	//////////// this.oceancolor = 0x4b8ad8;
	 this.gridcolor = 0xffffff;
////	 this.oceancolor = Math.random() * 0xebcc83;
	 this.oceancolor = 0xffffff;
///	 this.frontcolor = Math.random() * 0x103700;
	 this.frontcolor = 0xffffff;
	 this.cubeco = 0x141414;
////	 this.cubeco = Math.random() * 0xffffff;
	 this.cubeBco = 0x1f1f1f;
	 this.cubeZco = 0x00ff0f;
 
	this.noocean = false;
 	this.novid = false;
 	this.addterrain = false;
 	this.slideshow = false;

	this.mirrorvideo = 1;



}
function noVidski(novid) {
if (novid==true){
 ; 
 }
}


function onParamsChange() {
	vidmeshMaterial.opacity = params.mOpac;
	wireMaterial.opacity = params.wfOpac;


////// document.body.style.webkitFilter = "contrast(" + params.contrast + ") saturate(" + params.saturation + ")";
	
	 	noiseStrength = params.noiseStrength;

	  //// materiala.color = params.oceancolor;

//////// materiala = new THREE.MeshBasicMaterial( {color:params.oceancolor });

 /////////ocean.material.color = params.oceancolor; 
vidwireMaterial.color.set(params.gridcolor);
vidvidwireMaterial.color.set(params.gridcolor);
   		   wireMaterial.color.set(params.gridcolor); 
   		   vidmirrorg.material.color.set(params.oceancolor); 
///////    		  vidmirror.material.opacity=params.novid; 
  		   vidmirror.material.color.set(params.frontcolor); 
  /////////////////	vidmirror.visible = params.visible;


       
           document.body.style.cursor = 'none';
 
////var vidmirrorg = new THREE.Mesh(geometryg, immaterialaggg);


  	/////////// vidmirror.position.z = params.novid;
 
 /////////////materialag.opacity.set(params.novid);



 //////  	mirror.material.map = vidmeshMaterial	   
cube.material.color.set(params.cubeco);
cubeB.material.color.set(params.cubeBco);
cubeZ.material.color.set(params.cubeZco);

}

function getZDepths() {
	

      this.analyser.getByteFrequencyData(this.frequencyData);



 	ctxx.drawImage(this.videoV, 0, 0, canvasWidth + 1, canvasHeight + 1);
	pixels = ctxx.getImageData(0, 0, canvasWidth + 1, canvasHeight + 1).data;
	
		



////	noisePosn += params.noiseSpeed;


/*

	//draw webcam video pixels to canvas for pixel analysis
	//double up on last pixel get because there is one more vert than pixels
*/	





	for (var i = 0; i < canvasWidth + 1; i++) {
		for (var j = 0; j < canvasHeight + 1; j++) {
			var color = new THREE.Color(getColor(i, j));
			
			
			var brightness = getBrightness(color);
////// container.style.webkitFilter = "contrast(" + params.contrast + ") saturate(" + params.saturation + ")";
 ////	vidmeshMaterial.opacity = params.mOpac;
			
			
////   var gotoZ = (this.frequencyData[i]*1) * brightness - (this.frequencyData[i]*1);

 ////	var gotoZ = zDepth * brightness - zDepth / 2;
 
   var gotoZ = params.zDepth * brightness - params.zDepth / 1.9;


///// gotoZ += perlin.noise(i * params.noiseScale, j * params.noiseScale, noisePosn) * (this.frequencyData[i]);
 
///////	   gotoZ += perlin.noise(i * noiseScale, j * noiseScale, noisePosn) * noiseStrength - (this.frequencyData[i]*.5);

/////////
//
//////
 gotoZ += (this.frequencyData[i]*.3);
///////
////
//////////

////			var gotoZ = params.zDepth * brightness - params.zDepth / 2;
//////  			gotoZ += perlin.noise(i * params.noiseScale, j * params.noiseScale, noisePosn) * params.noiseStrength;

			//add noise wobble
 			//invert?
			if (params.invertZ) gotoZ = -gotoZ;
//tween to stablize
geometry.vertices[j * (canvasWidth+1) + i].z += (gotoZ - geometry.vertices[j * (canvasWidth+1 ) + i].z) / 5;

//tween to stablize	 
/*
this.Ground.vertices[j * (canvasWidth+1) + i].z += (gotoZ - this.Ground.vertices[j * (canvasWidth+1 ) + i].z) / 5;
*/
//tween to stablize
					
  		}


 		}
	geometry.verticesNeedUpdate = true;
	Ground.verticesNeedUpdate = true;
 









    var count = 0;
    var countB = 0;
    var countBB = 0;
        var countZ = 0;
        
        
             this.data_count = this.frequencyData.length;

////console.log(data_count);


/*
      */ 
cube_holder.children.forEach(function(i){
      //console.log(i);
      count++;
       scaler = this.frequencyData[count]*.023;

      if(scaler>0){
        if(scaler<.8){scaler=.8}
        data_count++;
   		  i.scale.set(10,scaler,10);        
       }
       
    });
    ///////
 
       
       
    cube_holderB.children.forEach(function(i){
      //console.log(i);
      countB++;
        scalerB = this.frequencyData[countB]*.023;

      if(scalerB>0){
        if(scalerB<.6){scalerB=.6}
        data_count++;
   		  i.scale.set(10,scalerB,10);        
       }
       
    });

 /*
    cubeZ_holder.children.forEach(function(i){
      //console.log(i);
      countZ++;
        scalerZ = this.frequencyData[countZ]*.003;

      if(scalerZ>0){
        if(scalerZ<.003){scalerZ=.003}
        data_count++;
   		  i.scale.set(10,scalerZ,10);        
       }
       
    });



             var kk;
            for(kk = 0; kk < 100; kk++){

 cubegeogeo = cubesgeo[kk];
 cubegeogeo.scale.x =  (this.frequencyData[kk]/72) + 1;
 cubegeogeo.scale.y =  (this.frequencyData[kk]/72) + 1;
 cubegeogeo.scale.z =  (this.frequencyData[kk]/72) + 1;
 //cube.material.color.setRGB(frequencyData[0]/255, (frequencyData[kk]/255), frequencyData[1023]/frequencyData[kk]);
//// cubegeogeo.material.color.setRGB((frequencyData[kk]/255), (frequencyData[kk]/255), frequencyData[1023]/frequencyData[kk]);
 cubegeogeo.rotation.y  -= (this.frequencyData[kk]/72) + .0005;            
 
 }


 */
 
   
    

/**/

//////////
//////
            var kks;
            for(kks = 0; kks < 66; kks++){

                sphere = sphereo[kks];
                sphere.scale.x =  (this.frequencyData[kks]/6) + .001;
                sphere.scale.y =  (this.frequencyData[kks]/6) + .001;
                sphere.scale.z =  (this.frequencyData[kks]/6) + .001;
  ///// sphere.material.color.setRGB(frequencyData[0]/255, (frequencyData[kks]/255), frequencyData[1023]/frequencyData[kks]);
           //////     cubegeogeo.material.color.setRGB(256, (frequencyData[kk]/255), 0);
       //  sphere.material.color.setRGB(256, (frequencyData[kks]/255), 0);

////////
//////////
//////////


            }




////////
////////


















//////////
//////////
///////////
////////////
//////////

 
 ////////////

 
    
 
 









 

  ///////////////////////  

 




////////////



var data_count = 0;
var global_count = 0;


 


 }



// Returns a hexidecimal color for a given pixel in the pixel array.

function getColor(x, y) {
	var base = (Math.floor(y) * (canvasWidth+1) + Math.floor(x)) * 4;
	var c = {
		r: this.pixels[base + 0],
		g: this.pixels[base + 1],
		b: this.pixels[base + 2],
		a: this.pixels[base + 3]
	};
	return (c.r << 16) + (c.g << 8) + c.b;
	
	
}

//return pixel brightness between 0 and 1 based on human perceptual bias

function getBrightness(c) {
	return (0.34 * c.r + 0.5 * c.g + 0.16 * c.b);
}
	 

	  
	
	
	
/////
///
/////




	////////////
	///////////
	
/////
///
/////
/*
function drawlines() {
 
  	linectxx.drawImage(video, 0, 0, 160+1, 120+1);
     pixelsb = linectxx.getImageData(0, 0, 160+1, 120+1).data;

   
 
 
  //	ctxx.drawImage(video, 0, 0, canvasWidth, canvasHeight);
   ////  console.log("Gray operation to be performed");
    // 32 bit image
 ///   pixels = linectxx.getImageData(0, 0, vidWidth, vidHeight).data;

 
  

  //  var channels = pixelsb.length/4;
///    for(var i=0;i<channels;i++){
///        var r = pixelsb[i*4 + 0];
//        var g = pixelsb[i*4 + 1];
 ///       var b = pixelsb[i*4 + 2];
 ///       var gray =  Math.round(0.21*r + 0.72*g + 0.07*b);
 ///       pixelsb[i*4 + 0] = gray;
 //       pixelsb[i*4 + 1] = gray;
 ///       pixelsb[i*4 + 2] = gray;
 ///   }

  //  console.log(pixelsb);
 ///   linectxx.putImageData;
    
    
  
    
    

 //  console.log(pixels.length);
//    console.log(pixels);



	
	   


	
	
   if (lines.length='') { } else { lineline = lines.length; }

  lines = lsd.lsd(this.pixels, 160, 120);

console.log("Found", lines.length, "line segments");
				
 var i,ii;
				var positions = [];

//////	var linegeometry = new THREE.Geometry();	
	var linematerial = new THREE.LineBasicMaterial({
            color: 0x0000ff
        });	
	
      var ln = ((this.linenumber) - (lines.length));  
      

          console.log(ln);
          console.log(linenumber);
          console.log(lines.length);
 
 





  
if (ln <=-40 || ln >=40){
for(i=0; i < lines.length; i++) {
 	
 world3D.remove(lineholder);
 world3D.add(lineholder);
 
   console.log("Line:", lines[i]);
  

					var x = lines[i].x1;
					var y = lines[i].y1;
				/////	var z = lines[i].y2-lines[i].y1;
					var z = 2;

				
					var xx = lines[i].x2;
					var yy = lines[i].y2;
				/////	var zz = lines[i].y1-lines[i].y2;
					var zz = 3;

 
var linegeometry = new THREE.Geometry();	
linegeometry.vertices.push(new THREE.Vector3(x, y, z)).normalize; //x, y, z
linegeometry.vertices.push(new THREE.Vector3(xx, yy, zz)).normalize;
 
 linegeometry.scale(1, 1, 1).


 
linesgeo = lines[i];
var line = new THREE.Line(linegeometry, linematerial);


					// positions
////// line.position = new THREE.Vector3(lines[i].x1, lines[i].y1, lines[i].y1 - ((lines[i].y2)));
//// line.position = new THREE.Float32BufferAttribute(lines[i].x1, lines[i].y1, lines[i].y1 - ((lines[i].y2)));

/////	  line.position = new THREE.Vector3((((lines[i].x1*10) - (lines[i].x1*10) - (lines[i].x2*10)) - (canvasWidth /2)) -(canvasHeight/2), ((lines[i].y1*10) - ((lines[i].y1*10) - (lines[i].y2*10))) - (canvasWidth /2), canvasHeight/2).normalize();


			 positions.push( x, y, z );

			 
	 ////	line.addAttribute( 'position', new THREE.Float32BufferAttribute( positions, 3 ) );

 
    var lengthX = Math.abs(lines[i].x1*10 - lines[i].x2*10);
            var lengthY = Math.abs(lines[i].y1*10 - lines[i].y2*10);

        	this.linenumber = lines.length;

            // create a cube to represent the wall segment
  var wallGeom = new THREE.BoxGeometry(lengthX, 3, lengthY);
  var wallMaterial = new THREE.MeshPhongMaterial({color: 0xff0000, opacity: 0.8, transparent: true});


            // and create the complete wall segment
            var wallMesh = new THREE.Mesh(wallGeom, wallMaterial);


            // finally position it correctly

  wallMesh.position = new THREE.Vector3((((lines[i].x1*10) - (lines[i].x1*10) - (lines[i].x2*10)) - (canvasWidth /2)) -(canvasHeight/2), ((lines[i].y1*10) - ((lines[i].y1*10) - (lines[i].y2*10))) - (canvasWidth /2), wallGeom.height/2).normalize();
 

/////wallMesh.position = new THREE.Vector3(lines[i].x1 - ((lines[i].x1 - lines[i].x2) / 2) -(canvasHeight/2), wallGeom.height/2, lines[i].y1 - ((lines[i].y1 - lines[i].y2)) / 2 - (canvasWidth /2));
 
 
/////  wallMesh.position = new THREE.Vector3(lines[i].x1, lines[i].y1, lines[i].y1 - ((lines[i].y2)));
 
    // iterate the vertexColors
    // like in http://stackoverflow.com/questions/17874682/dynamically-change-vertex-color-in-three-js
 ///   for ( var j = 0; j < wallGeom.vertices[i].vertexColors.length; j ++ ) {
///        wallGeom.vertices[i].vertexColors[j].setHSL(currentNormal.x, currentNormal.y, currentNormal.z);
////    }
      
///////  lineholder.add(wallMesh);


  lineholder.add(line);


 
     ///    linesgeo.push( wallMesh );
  ////////// world3D.updateMatrixWorld();
  ///////  self.elements.push(wallMesh);   
  ///      world3D.add(wallMesh); 
    /////    world3D.add(line); 
        
        
        
/////////   var grid = new THREE.LineSegments(linegeometry, linematerial);
///////////////   world3D.add(wallMesh); 
///// world3D.add(grid); 

}

 
}


 
  

 
				for ( var i = 0; i < segments; i ++ ) {
					var x = Math.random() * r - r / 2;
					var y = Math.random() * r - r / 2;
					var z = Math.random() * r - r / 2;
					// positions
					// colors
					colors.push( ( x / r ) + 0.5 );
					colors.push( ( y / r ) + 0.5 );
					colors.push( ( z / r ) + 0.5 );
				}  
				
				
				
				 
			//	geometry.addAttribute( 'position', new THREE.Float32BufferAttribute( positions, 3 ) );
		///		geometry.addAttribute( 'color', new THREE.Float32BufferAttribute( colors, 3 ) );
		///		geometry.computeBoundingSphere();
		//		mesh = new THREE.Line( geometry, material );
		///		scene.add( mesh );
				
				
			 
				
			
			
			}

////
///
////

 
 */
 
	
	//////
	///////
	///////
	////////////////
	/////
	///
	///////
	
	
	

  function animate (timestamp) {
  
  

 

  
  var delta = Math.min(timestamp - lastRender, 500);
 ////// 	var t = clock.getElapsedTime();
 lastRender = timestamp;



   /// TWEEN.update(timestamp);
   
    /*
 
	lines.forEach( function( l, i ) {
		if( params.animateWidth ) l.material.uniforms.lineWidth.value = params.lineWidth * ( 1 + .5 * Math.sin( 5 * t + i ) );
		if( params.autoRotate ) l.rotation.y += .125 * delta;
      l.material.uniforms.visibility.value= params.animateVisibility ? (time/3000) % 1.0 : 1.0;
	} );

*/


 	

  controls.update();

  // Render the scene through the manager.
  manager.render(scene, camera, timestamp);


 


  
 	if (videoV.readyState === videoV.HAVE_ENOUGH_DATA) {
	 	videoTextureV.needsUpdate = true;
 ////	
getZDepths();
////drawvid();
 }
	  
  				   requestAnimationFrame( animate );
 
 
 
 /*
 
 	drawCount = ( drawCount + 1 ) % MAX_POINTS;

	llline.geometry.setDrawRange( 0, drawCount );

	if ( drawCount === 0 ) {

		// periodically, generate new data

	///	updatePositions();

		llline.geometry.attributes.position.needsUpdate = true; // required after the first render

		llline.material.color.setHSL( Math.random(), 1, 0.5 );

	}
 
  
 */
 


////
/////


 

///var container = this.getContainerDimensions();
 var halfWidth  = width / 2;
 var halfHeight = width / 2;

 		

///////
//////
/////////
/////
 
  


     //   this.analyser.getByteFrequencyData(this.frequencyData);


//////       this.analyser.getByteTimeDomainData(this.dataArray);
	///////array = new Uint8Array(analyser.frequencyBinCount);
				
				
 				
				
/////this.analyser.getByteFrequencyData(this.frequencyData);
////this.analyser.getByteTimeDomainData(this.frequencyData);
  


///console.log(this.bufferLength);
////console.log(this.frequencyData);



 //////
 			  
 


 
//////////
////////// 
  //// 
 
//////////
//////

 
 
 

//////	world3D.scale = new THREE.Vector3(params.zoom, params.zoom, 1);
	
	/*
	
	
	world3D.rotation.x += ((mouseY * tiltAmount) - world3D.rotation.x) * tiltSpeed;
	world3D.rotation.y += ((mouseX * tiltAmount) - world3D.rotation.y) * tiltSpeed;
	//camera.lookAt(camera.target);
	/////////// renderer.render(scene, camera);
	*/
}





 



function success_stream(stream){
   ///// video_frame.src = window.URL.createObjectURL(stream);
 	 
	 
			//////	array = new Uint8Array(analyser.frequencyBinCount);
				
				
 				
				
			 ////  frequencyData = new Uint8Array(analyser.frequencyBinCount);

////this.analyser.getByteFrequencyData(this.frequencyData);


	$('#loading_dots').text('');
		
			$('body').addClass('loaded');

			// popup
			$('body').append($('<div onclick="play();" id="play" style="width: ' + $(window).width() + 'px; height: ' + $(window).height() + 'px;"><div id="play_link"></div></div>'));
			$('#play_link').css('top', ($(window).height() / 2 - $('#play_link').height() / 2) + 'px');
			$('#play_link').css('left', ($(window).width() / 2 - $('#play_link').width() / 2) + 'px');
			$('#play').fadeIn();
			
			
			
			
			
		





		var source = audioCtx.createMediaElementSource(video_frame);
		source.connect(analyser);
animate();
}

function error_stream(err){
    console.log("Error : " + err);
}


function startTracking() {
    mt.run();
}

function stopTracking() {
    mt.stop();
}

function color_tracking_handler(e){
    if(e.data.length === 0){
        console.log("No trackable sutff");
         if(!this.meshwa) {} else { this.world3D.remove(this.meshwa); this.meshwa.geometry.dispose(); this.meshwa.material.dispose(); }

    }else{
        imcanvas.drawImage(video_frame, 0, 0, canvasWidth, canvasHeight);
    //////   e.data.forEach(drawBoundingBox);
    }
}


function drawBoundingBox(rect){
    console.log(rect.x +" " + rect.y);

/*

    imcanvas.beginPath();
    imcanvas.lineWidth = "2";
    imcanvas.strokeStyle = 'red';
    imcanvas.rect(rect.x, rect.y, rect.width, rect.height);
    imcanvas.stroke();
    // video_frame.src = imcanvas;
    
    
*/






if ((xmin -10)>rect.x || (xmax + 10)<rect.x ) {} else {

	///	createLines(rect);
 	/// makeLine( createCurve(rect) );


	world3D.add( llline );

	// update positions
var llpositions = llline.geometry.attributes.position.array;

	var x = rect.x;
	var y = rect.y;
///	var z = rect.height;
	var z = -196;
	var index = 0;

	for ( var i = 0, l = MAX_POINTS; i < l; i ++ ) {

		llpositions[ index ++ ] = x;
		llpositions[ index ++ ] = y;
		llpositions[ index ++ ] = z;

		x += ( Math.random() - 0.5 ) * 30;
		y += ( Math.random() - 0.5 ) * 30;
		z += ( Math.random() - 0.5 ) * 90;

	}

// console.log(oldx);
//// console.log(oldy);

//// console.log(rect.x);
///// console.log(rect.y);


var coords = { x: oldx, y:oldy }; // Start at (0, 0)
var tween = new TWEEN.Tween(coords) // Create a new tween that modifies 'coords'.
        .to({ x: rect.x, y: rect.y }, 800) // Move to (300, 200) in 1 second.
        .easing(TWEEN.Easing.Elastic.InOut)
        .delay(50) // Use an easing function to make the animation smooth.
        .onUpdate(function() { // Called after tween.js updates 'coords'.
            // Move 'box' to the position described by 'coords' with a CSS translation.
                meshwa.position.x = coords.x;
    meshwa.position.y = coords.y;
    meshwa.position.z = -196;

                lmholder.position.x = coords.x;
    lmholder.position.y = coords.y;
    lmholder.position.z = -196;





          ///  meshwa.position.set(coords.x,coords.y,rect.height);
        })
        .start(); // Start the tween immediately.
        
        
        
        



/*
meshwa.position.z = rect.height;
     //////////////   meshwa.position.y = -136;
meshwa.position.y = rect.y;
meshwa.position.x=rect.x;
*/
   //////	meshwa.rotation.y = Math.PI / Math.random();
 world3D.add(meshwa);
    
      xmin=(rect.x -15);
  xmax=(rect.x+15);
 oldx=rect.x;
 oldy=rect.y;
 oldz=rect.height;
    }
    
     	
    	
    	
}


function drawvid() {
 
  	  videoTexture.needsUpdate = true;
  	ctxx.drawImage(video_frame, 0, 0, canvasWidth, canvasHeight);
   ////  console.log("Gray operation to be performed");
    // 32 bit image
    pixels = ctxx.getImageData(0, 0, canvasWidth, canvasHeight).data;

 
	}
	
 





function onResize() {
 	windowHalfX = window.innerWidth / 2;
	windowHalfY = window.innerHeight / 2;
	
  canvas_height = window.innerHeight;
  canvas_width = window.innerWidth;
  camera.aspect = canvas_width / canvas_height;
  camera.updateProjectionMatrix();
  renderer.setSize( canvas_width, canvas_height );

}

 


/////
//
/////



function createLine(rect) {
///	if( params.circles ) makeLine( hexagonGeometry );
////	if( params.curves ) makeLine( createCurve() );
	 makeLine( createCurve(rect) );
	//makeLine( makeVerticalLine() );
	//makeLine( makeSquare() );
}

function createLines(rect) {
	for( var j = 0; j < params.amount; j++ ) {
		createLine(rect);
	}
}

function makeVerticalLine() {
	var g = new THREE.Geometry()
	var x = ( .5 - Math.random() ) * 100;
	g.vertices.push( new THREE.Vector3( x, -10, 0 ) );
	g.vertices.push( new THREE.Vector3( x, 10, 0 ) );
	return g;
}

function makeSquare() {
	var g = new THREE.Geometry()
	var x = ( .5 - Math.random() ) * 100;
	g.vertices.push( new THREE.Vector3( -1, -1, 0 ) );
	g.vertices.push( new THREE.Vector3( 1, -1, 0 ) );
	g.vertices.push( new THREE.Vector3( 1, 1, 0 ) );
	g.vertices.push( new THREE.Vector3( -1, 1, 0 ) );
	g.vertices.push( new THREE.Vector3( -1, -1, 0 ) );
	return g;
}


/////
///
////

         
///////////////////////////////////////////////
// Play and Pause Button
///////////////////////////////////////////////

$('#play_link').click(function(){

	/////////	$('body').addClass('loaded');

       	$('#play').fadeOut('normal', function() {
		$(this).remove();
	});
       	$('#info').fadeOut('normal', function() {
		$(this).remove();
	});
       	$('#intro').fadeOut('normal', function() {
		/////////////$(this).remove();
	});
       	$('#infoB').fadeOut('normal', function() {
		////////////////$(this).remove();
	});
/////       	$('#cursorhelp').fadeIn('normal', function() {
		////////////////$(this).remove();
/////////	});

       	$('#play_link').fadeOut('normal', function() {
		$(this).remove();
	});
 
/////////////////// timer starter from removed timer ////startstory();
  
});





  
			
	</script>		
<!-- 
    <script src="track2.js"></script>
-->
</body>
</html>